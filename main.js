!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},t=(e,t,o)=>{const n=e.querySelector(`#${t.id}-error`);t.classList.remove(o.inputErrorClass),n.textContent=""},o=e=>e.some((e=>!e.validity.valid)),n=(e,t,n)=>{console.log(o(e)),o(e)?r(t,n):a(t,n)},r=(e,t)=>{e.classList.add(t.inactiveButtonClass),e.disabled=!0},a=(e,t)=>{e.classList.remove(t.inactiveButtonClass),e.disabled=!1},s=document.querySelector(".profile__name"),l=document.querySelector(".profile__description"),c=document.querySelector(".profile__edit-button"),i=document.querySelector("#edit-modal"),u=i.querySelector(".modal__close-button"),d=i.querySelector("#profile-name-input"),m=i.querySelector("#profile-description-input"),p=i.querySelector(".modal__form"),_=document.querySelector("#card-template"),y=document.querySelector(".cards__list"),f=document.querySelector(".profile__add-button"),v=document.querySelector("#card-modal"),S=v.querySelector(".modal__close-button"),g=v.querySelector(".modal__form"),q=v.querySelector("#card-caption-input"),b=v.querySelector("#card-link-input"),w=v.querySelector(".modal__submit-button"),h=document.querySelector("#preview-modal"),L=document.querySelector(".modal__image"),k=document.querySelector(".modal__caption"),E=document.querySelector(".modal__close-button_type_preview");function x(e){const t=_.content.querySelector(".card").cloneNode(!0),o=t.querySelector(".card__title"),n=t.querySelector(".card__like-button"),r=t.querySelector(".card__image"),a=t.querySelector(".card__delete-button");return o.textContent=e.name,r.src=e.link,r.alt=e.name,n.addEventListener("click",(()=>{n.classList.toggle("card__like-button_liked")})),a.addEventListener("click",(()=>{t.remove()})),r.addEventListener("click",(()=>{C(h),L.src=e.link,k.textContent=e.name,L.alt=e.name})),t}function C(e){document.addEventListener("keydown",A),e.classList.add("modal_opened")}function z(e){document.removeEventListener("keydown",A),e.classList.remove("modal_opened")}f.addEventListener("click",(()=>{C(v)})),S.addEventListener("click",(()=>{z(v)})),i.addEventListener("mousedown",(e=>{e.target.classList.contains("modal")&&z(i)})),h.addEventListener("mousedown",(e=>{e.target.classList.contains("modal")&&z(h)})),v.addEventListener("mousedown",(e=>{e.target.classList.contains("modal")&&z(v)}));const A=e=>{if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&z(e)}};var j;p.addEventListener("submit",(function(e){e.preventDefault(),s.textContent=d.value,l.textContent=m.value,z(i)})),g.addEventListener("submit",(function(t){t.preventDefault(),console.log(b.value),console.log(q.value);const o=x({name:q.value,link:b.value});y.prepend(o),t.target.reset(),r(w,e),z(v)})),c.addEventListener("click",(()=>{var o,n;d.value=s.textContent,m.value=l.textContent,o=p,n=e,Array.from(o.querySelectorAll(n.inputSelector)).forEach((e=>{t(o,e,n)})),C(i)})),u.addEventListener("click",(()=>{z(i)})),E.addEventListener("click",(()=>{z(h)})),[{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"The Golden Gate Bridge",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"}].forEach((e=>{console.log(e);const t=x(e);y.append(t)})),j=e,Array.from(document.querySelectorAll(j.formSelector)).forEach((e=>{((e,o)=>{const r=Array.from(e.querySelectorAll(o.inputSelector)),a=e.querySelector(o.submitButtonSelector);n(r,a,o),r.forEach((s=>{s.addEventListener("input",(function(){((e,o,n)=>{console.log(o.validationMessage),o.validity.valid?t(e,o,n):((e,t,o,n)=>{const r=e.querySelector(`#${t.id}-error`);t.classList.add(n.inputErrorClass),r.textContent=o})(e,o,o.validationMessage,n)})(e,s,o),n(r,a,o)}))}))})(e,j)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFjQyxLQUNyRGMsUUFBUUMsSUFBSWhCLEVBQWFtRixtQkFDcEJuRixFQUFhVyxTQUFTQyxNQVF6QmQsRUFBZUMsRUFBYUMsRUFBY0MsR0FoRnZCbUYsRUFBQ3JGLEVBQWFDLEVBQWNxRixFQUFjcEYsS0FHL0QsTUFBTXFGLEVBQXNCdkYsRUFBWUksY0FDdEMsSUFBSUgsRUFBYUksWUFFbkJKLEVBQWFLLFVBQVVjLElBQUlsQixFQUFPTCxpQkFDbEMwRixFQUFvQi9FLFlBQWM4RSxDQUFZLEVBa0U1Q0QsQ0FDRXJGLEVBQ0FDLEVBQ0FBLEVBQWFtRixrQkFDYmxGLEVBSUosRUFqQklpRixDQUFtQm5GLEVBQWFDLEVBQWNDLEdBQzlDWSxFQUFrQkosRUFBV0ssRUFBZWIsRUFDOUMsR0FBRSxHQUNGLEVBb0JBZ0YsQ0FBa0JsRixFQUFhRSxFQUFPLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGUuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXG59O1xuXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xuICAvLyBjb25zdCBlcnJvck1lc3NhZ2VJRCA9IGlucHV0RWxlbWVudC5pZCArIFwiLWVycm9yXCI7XG4gIC8vIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgZXJyb3JNZXNzYWdlSUQpO1xuICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgKTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG59O1xuXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbn07XG5cbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zb2xlLmxvZyhoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSk7XG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBlbmFibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xufTtcblxuY29uc3QgZW5hYmxlQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG59O1xuXG4vLyByZXNldHMgdGhlIHZhbGlkYXRpb24gc3RhdGUgb2YgYSBmb3JtIHNvIHRoYXQgdGhlIGVycm9yIG1lc3NhZ2VzIGFyZSBub3QgZGlzcGxheWVkIHVwb24gcmVvcGVuaW5nIGFmdGVyIGFuXG4vLyBpbnZhbGlkIHN1Ym1pc3Npb24gd2hlbiB0aGUgZm9ybSBpbnB1dHMgYXJlIGZpbGxlZCB3aXRoIHZhbGlkIHByZXhpc3RpbmcgZGF0YVxuLy8gY2FsbCB3aGVuIG1vZGFsIG9wZW5lZCB0byByZXNldCBlcnJvciBtZXNzYWdlIGFuZCBjYWxsIG9uIGV2ZW50IGxpc3RlbmVyXG4vLyAobm90ZSBmb3IgbXlzZWxmKSBDR1xuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcilcbiAgKTtcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0LCBjb25maWcpO1xuICB9KTtcbn07XG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxuICApO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnNvbGUubG9nKGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoXG4gICAgICBmb3JtRWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcbiAgICAgIGNvbmZpZ1xuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcbiAgfSk7XG59O1xuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCB7XG4gIGVuYWJsZVZhbGlkYXRpb24sXG4gIHZhbGlkYXRpb25Db25maWcsXG4gIC8vIHNob3dJbnB1dEVycm9yLFxuICAvLyBoaWRlSW5wdXRFcnJvcixcbiAgLy8gaGFzSW52YWxpZElucHV0LFxuICAvLyB0b2dnbGVCdXR0b25TdGF0ZSxcbiAgZGlzYWJsZUJ1dHRvbixcbiAgLy8gZW5hYmxlQnV0dG9uLFxuICByZXNldFZhbGlkYXRpb24sXG4gIC8vIHNldEV2ZW50TGlzdGVuZXJzLFxuICAvLyBjaGVja0lucHV0VmFsaWRpdHksXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRlLmpzXCI7XG5cbi8vY2FyZC5jc3Ncbi8vIGltcG9ydCB1bmlvblNyYyBmcm9tIFwiLi4vaW1hZ2VzL1VuaW9uLnN2Z1wiO1xuLy8gY29uc3QgdW5pb25JbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidW5pb24taW1hZ2VcIik7XG4vLyB1bmlvbkltYWdlLnNyYyA9IHVuaW9uU3JjO1xuLy8gaW1wb3J0IHVuaW9uTGlrZWRTcmMgZnJvbSBcIi4uL2ltYWdlcy91bmlvbi1saWtlZC5zdmdcIjtcbi8vIGNvbnN0IHVuaW9uTGlrZWRJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidW5pb24tbGlrZWQtaW1hZ2VcIik7XG4vLyB1bmlvbkxpa2VkSW1hZ2Uuc3JjID0gdW5pb25MaWtlZFNyYztcbi8vIGltcG9ydCB1bmlvbkxpa2VkSG92ZXJTcmMgZnJvbSBcIi4uL2ltYWdlcy91bmlvbi1saWtlZC1ob3Zlci5zdmdcIjtcbi8vIGNvbnN0IHVuaW9uTGlrZWRIb3ZlckltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ1bmlvbi1saWtlZC1ob3Zlci1pbWFnZVwiKTtcbi8vIHVuaW9uTGlrZWRIb3ZlckltYWdlLnNyYyA9IHVuaW9uTGlrZWRIb3ZlclNyYztcbi8vIGltcG9ydCBjYW5TcmMgZnJvbSBcIi4uL2ltYWdlcy9jYW4ucG5nXCI7XG4vLyBjb25zdCBjYW5JbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FuLWltYWdlXCIpO1xuLy8gY2FuSW1hZ2Uuc3JjID0gY2FuU3JjO1xuLy8gaW1wb3J0IGNhbkhvdmVyU3JjIGZyb20gXCIuLi9pbWFnZXMvY2FuaG92ZXIucG5nXCI7XG4vLyBjb25zdCBjYW5Ib3ZlckltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW4taG92ZXItaW1hZ2VcIik7XG4vLyBjYW5Ib3ZlckltYWdlLnNyYyA9IGNhbkhvdmVyU3JjO1xuXG4vLyAvL21vZGFsLmNzc1xuLy8gaW1wb3J0IGNsb3NlSWNvblNyYyBmcm9tIFwiLi4vaW1hZ2VzL2Nsb3NlMi5zdmdcIjtcbi8vIGNvbnN0IGNsb3NlSWNvbkltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjbG9zZS1pY29uLWltYWdlXCIpO1xuLy8gY2xvc2VJY29uSW1hZ2Uuc3JjID0gY2xvc2VJY29uU3JjO1xuLy8gaW1wb3J0IGNsb3NlSWNvblRyYW5zU3JjIGZyb20gXCIuLi9pbWFnZXMvY2xvc2VpY29udHJhbnMuc3ZnXCI7XG4vLyBjb25zdCBjbG9zZUljb25UcmFuc0ltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjbG9zZS1pY29uLXRyYW5zLWltYWdlXCIpO1xuLy8gY2xvc2VJY29uVHJhbnNJbWFnZS5zcmMgPSBjbG9zZUljb25UcmFuc1NyYztcblxuLy9GVU5DVElPTkFMSVkgV0hFUkUgTU9EQUwgQ0xPU0VTIEFGVEVSIENSRUFUSVVPTiBPRiBORVcgQ0FSRCBBUyBXRUxMIEFTIEVESVQgUE9ST0ZJTEUgQlVUVE9OIEFSRSBOT1QgV09FUktJTkdcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVGhlIEdvbGRlbiBHYXRlIEJyaWRnZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy83LXBob3RvLWJ5LWdyaWZmaW4td29vbGRyaWRnZS1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbl07XG5cbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbW9kYWxcIik7XG5jb25zdCBwcm9maWxlQ2xvc2VCdXR0b24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIlxuKTtcbmNvbnN0IGVkaXRNb2RhbE5hbWVJbnB1dCA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1uYW1lLWlucHV0XCJcbik7XG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0ID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5jb25zdCBwcm9maWxlRm9ybUVsZW1lbnQgPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuY29uc3QgY2FyZE1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuY29uc3QgY2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLW1vZGFsXCIpO1xuY29uc3QgY2FyZE1vZGFsQ2xvc2VCdXR0b24gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xuY29uc3QgY2FyZEZvcm0gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGNhcmRDYXB0aW9uSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLWNhcHRpb24taW5wdXRcIik7XG5jb25zdCBjYXJkTGlua0lucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1saW5rLWlucHV0XCIpO1xuY29uc3QgY2FyZFN1Ym1pdEJ1dHRvbiA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuY29uc3QgcHJldmlld01vZGFsSW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbmNvbnN0IHByZXZpZXdNb2RhbENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvbl90eXBlX3ByZXZpZXdcIlxuKTtcblxuZnVuY3Rpb24gaGFuZGxlQ2FyZFN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnNvbGUubG9nKGNhcmRMaW5rSW5wdXQudmFsdWUpO1xuICBjb25zb2xlLmxvZyhjYXJkQ2FwdGlvbklucHV0LnZhbHVlKTtcbiAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7XG4gICAgbmFtZTogY2FyZENhcHRpb25JbnB1dC52YWx1ZSxcbiAgICBsaW5rOiBjYXJkTGlua0lucHV0LnZhbHVlLFxuICB9O1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGlucHV0VmFsdWVzKTtcbiAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICBldnQudGFyZ2V0LnJlc2V0KCk7XG4gIGRpc2FibGVCdXR0b24oY2FyZFN1Ym1pdEJ1dHRvbiwgdmFsaWRhdGlvbkNvbmZpZyk7IC8vc2V0dGluZ3NcbiAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xufVxuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgY29uc3QgY2FyZE5hbWVFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZExpa2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICBjb25zdCBjYXJkSW1hZ2VFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgY2FyZERlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcbiAgY2FyZE5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1hZ2VFbGVtZW50LnNyYyA9IGRhdGEubGluaztcbiAgY2FyZEltYWdlRWxlbWVudC5hbHQgPSBkYXRhLm5hbWU7XG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xuICB9KTtcbiAgY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9KTtcbiAgY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICAgIHByZXZpZXdNb2RhbEltYWdlRWxlbWVudC5zcmMgPSBkYXRhLmxpbms7XG4gICAgcHJldmlld01vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVsZW1lbnQuYWx0ID0gZGF0YS5uYW1lO1xuICB9KTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlS2V5KTtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGVLZXkpO1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChldmVudCkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZTtcbiAgY2xvc2VNb2RhbChwcm9maWxlRWRpdE1vZGFsKTtcbn1cblxuY2FyZE1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChjYXJkTW9kYWwpO1xufSk7XG5jYXJkTW9kYWxDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XG59KTtcblxucHJvZmlsZUVkaXRNb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xuICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XG4gICAgY2xvc2VNb2RhbChwcm9maWxlRWRpdE1vZGFsKTtcbiAgfVxufSk7XG5cbnByZXZpZXdNb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xuICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XG4gICAgY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xuICB9XG59KTtcblxuY2FyZE1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2ZW50KSA9PiB7XG4gIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcbiAgICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XG4gIH1cbn0pO1xuXG5jb25zdCBoYW5kbGVFc2NhcGVLZXkgPSAoZXZlbnQpID0+IHtcbiAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgaWYgKG9wZW5lZE1vZGFsKSB7XG4gICAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcbiAgICB9XG4gIH1cbn07XG5cbnByb2ZpbGVGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcbmNhcmRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQ2FyZFN1Ym1pdCk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xuICBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24ocHJvZmlsZUZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTsgLy9zZXR0aW5nc1xuICBvcGVuTW9kYWwocHJvZmlsZUVkaXRNb2RhbCk7XG59KTtcbnByb2ZpbGVDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKHByb2ZpbGVFZGl0TW9kYWwpO1xufSk7XG5wcmV2aWV3TW9kYWxDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKHByZXZpZXdNb2RhbCk7XG59KTtcblxuaW5pdGlhbENhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcbiAgY29uc29sZS5sb2coY2FyZCk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XG4gIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xufSk7XG5cbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7XG4iXSwibmFtZXMiOlsidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImNvbmZpZyIsImVycm9yRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRleHRDb250ZW50IiwiaGFzSW52YWxpZElucHV0IiwiaW5wdXRMaXN0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImJ1dHRvbkVsZW1lbnQiLCJjb25zb2xlIiwibG9nIiwiZGlzYWJsZUJ1dHRvbiIsImVuYWJsZUJ1dHRvbiIsImFkZCIsImRpc2FibGVkIiwicHJvZmlsZU5hbWUiLCJkb2N1bWVudCIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVDbG9zZUJ1dHRvbiIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlRm9ybUVsZW1lbnQiLCJjYXJkVGVtcGxhdGUiLCJjYXJkc0xpc3QiLCJjYXJkTW9kYWxCdXR0b24iLCJjYXJkTW9kYWwiLCJjYXJkTW9kYWxDbG9zZUJ1dHRvbiIsImNhcmRGb3JtIiwiY2FyZENhcHRpb25JbnB1dCIsImNhcmRMaW5rSW5wdXQiLCJjYXJkU3VibWl0QnV0dG9uIiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsSW1hZ2VFbGVtZW50IiwicHJldmlld01vZGFsQ2FwdGlvbiIsInByZXZpZXdNb2RhbENsb3NlQnV0dG9uIiwiZ2V0Q2FyZEVsZW1lbnQiLCJkYXRhIiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbGVtZW50IiwiY2FyZExpa2VCdXR0b24iLCJjYXJkSW1hZ2VFbGVtZW50IiwiY2FyZERlbGV0ZUJ1dHRvbiIsIm5hbWUiLCJzcmMiLCJsaW5rIiwiYWx0IiwiYWRkRXZlbnRMaXN0ZW5lciIsInRvZ2dsZSIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwiaGFuZGxlRXNjYXBlS2V5IiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldmVudCIsInRhcmdldCIsImNvbnRhaW5zIiwia2V5Iiwib3BlbmVkTW9kYWwiLCJwcmV2ZW50RGVmYXVsdCIsInZhbHVlIiwiZXZ0IiwicHJlcGVuZCIsInJlc2V0IiwicmVzZXRWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpbnB1dCIsImNhcmQiLCJhcHBlbmQiLCJzZXRFdmVudExpc3RlbmVycyIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkYXRpb25NZXNzYWdlIiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJlcnJvck1lc3NhZ2VFbGVtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==